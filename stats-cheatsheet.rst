.. raw:: html

	<style type="text/css">.menu>li.statistics-on>a {background:#e2e2e2;cursor: default;}</style>

Statistics cheatsheet
=====================

In the Python code :code:`import pandas as pd` has been run


Basics
-------

.. container:: multilang-table

    +----------------------------------+-----------------------------------------------+----------------------------------------------+--------------------------------------------+
    |            Operation             |                     STATA                     |                    Pandas                    |                   Base R                   |
    +==================================+===============================================+==============================================+============================================+
    |                                  | .. code-block:: none                          | .. code-block:: python                       | .. code-block:: none                       |
    |                                  |                                               |                                              |                                            |
    |  Create new dataset from values  |      input a b                                |     d = {'a' : [1,2,3], 'b' : [4,5,6]}       |     df <- data.frame(a=1:3, b=4:6)         |
    |                                  |      1 4                                      |                                              |                                            |
    |                                  |      2 5                                      |     df = pd.DataFrame(d)                     |                                            |
    |                                  |      3 6                                      |                                              |                                            |
    |                                  |      end                                      |                                              |                                            |
    +----------------------------------+-----------------------------------------------+----------------------------------------------+--------------------------------------------+
    |                                  | .. code-block:: none                          | .. code-block:: python                       | .. code-block:: none                       |
    |                                  |                                               |                                              |                                            |
    | Create new dataset from csv file |      import delim mydata.csv, delimiters(",") |      df = pd.read_csv('mydata.csv', sep=',') |     df <- read.csv('my_data.csv', sep=',') |
    +----------------------------------+-----------------------------------------------+----------------------------------------------+--------------------------------------------+
    |                                  | .. code-block:: none                          | .. code-block:: python                       | .. code-block:: none                       |
    |                                  |                                               |                                              |                                            |
    | Print observations               |     list                                      |     df                                       |     df                                     |
    +----------------------------------+-----------------------------------------------+----------------------------------------------+--------------------------------------------+
    |                                  | .. code-block:: none                          | .. code-block:: python                       | .. code-block:: none                       |
    |                                  |                                               |                                              |                                            |
    | Print observations of variable x |     list x                                    |     df['x']                                  |     df$x                                   |
    +----------------------------------+-----------------------------------------------+----------------------------------------------+--------------------------------------------+
    |                                  | .. code-block:: none                          | .. code-block:: python                       | .. code-block:: none                       |
    |                                  |                                               |                                              |                                            |
    | Select only variable x           |     keep x                                    |     df = df['x']                             |     df <- df$x                             |
    +----------------------------------+-----------------------------------------------+----------------------------------------------+--------------------------------------------+
    |                                  | .. code-block:: none                          | .. code-block:: python                       | .. code-block:: none                       |
    |                                  |                                               |                                              |                                            |
    | Select only variables x and y    |     keep x y                                  |     df = df[['x', 'y']]                      |     df <- df[c(‘x’, ‘y’)]                  |
    +----------------------------------+-----------------------------------------------+----------------------------------------------+--------------------------------------------+
    |                                  | .. code-block:: none                          | .. code-block:: python                       | .. code-block:: none                       |
    |                                  |                                               |                                              |                                            |
    | Drop variable x                  |      drop x                                   |     del x                                    |    df$x <- NULL                            |
    |                                  |                                               |                                              |                                            |
    |                                  |                                               |                                              |                                            |
    |                                  |                                               |                                              |                                            |
    |                                  |                                               |                                              |                                            |
    +----------------------------------+-----------------------------------------------+----------------------------------------------+--------------------------------------------+
    |                                  | .. code-block:: none                          | .. code-block:: python                       | .. code-block:: none                       |
    |                                  |                                               |                                              |                                            |
    | Generate new variable            |      gen z = x + y                            |      df['z'] = df['x'] + df['y']             |     df$z <- df$x + df$y                    |
    +----------------------------------+-----------------------------------------------+----------------------------------------------+--------------------------------------------+
    |                                  | .. code-block:: none                          | .. code-block:: python                       | .. code-block:: none                       |
    |                                  |                                               |                                              |                                            |
    | Rename variable                  |     rename x y                                |     df.rename(columns = {'x' : 'y'})         |     names(df)[names(df) == ‘x’] <- ‘y’     |
    +----------------------------------+-----------------------------------------------+----------------------------------------------+--------------------------------------------+
    |                                  | .. code-block:: none                          | .. code-block:: python                       | .. code-block:: none                       |
    |                                  |                                               |                                              |                                            |
    | Sort by variable                 |      sort x                                   |      df.sort_values('x')                     |     df[order(df$x), ]                      |
    +----------------------------------+-----------------------------------------------+----------------------------------------------+--------------------------------------------+


Filtering data
--------------

.. container:: multilang-table

    +------------------------------------------------------+---------------------------+---------------------------------------+--------------------------------+
    |                      Operation                       |           STATA           |                 Pandas                |             Base R             |
    +======================================================+===========================+=======================================+================================+
    |                                                      | .. code-block:: none      | .. code-block:: python                | .. code-block:: none           |
    |                                                      |                           |                                       |                                |
    | Conditionally print observations                     |     list if x > 1         |    df[df['x'] > 1]                    |     subset(df, x == 1)         |
    +------------------------------------------------------+---------------------------+---------------------------------------+--------------------------------+
    |                                                      | .. code-block:: none      | .. code-block:: python                | .. code-block:: none           |
    |                                                      |                           |                                       |                                |
    | Conditionally print observations with 'or' operator  |     list x if > 1  y < 0  |     df[(df['x'] > 1) | (df['y'] < 0)] |     subset(df, x == 1 | y < 0) |
    +------------------------------------------------------+---------------------------+---------------------------------------+--------------------------------+
    |                                                      | .. code-block:: none      | .. code-block:: python                | .. code-block:: none           |
    |                                                      |                           |                                       |                                |
    | Conditionally print observations with 'and' operator |     list if x < 1 & y > 5 |     df[(df['x'] > 1) & (df['y'] < 0)] |     subset(df, x == 1 & y < 0) |
    +------------------------------------------------------+---------------------------+---------------------------------------+--------------------------------+
    |                                                      | .. code-block:: none      | .. code-block:: python                | .. code-block:: none           |
    |                                                      |                           |                                       |                                |
    | Print subset of observations based on location       |     list in 1/3           |     df[0:3]                           |     df[1:3, ]                  |
    +------------------------------------------------------+---------------------------+---------------------------------------+--------------------------------+
    |                                                      | .. code-block:: none      | .. code-block:: python                | .. code-block:: none           |
    |                                                      |                           |                                       |                                |
    | Print observations with missing values in x          |     list if x >= .        |     df[df['x'].isnull()]              |     subset(df, is.na(x))       |
    +------------------------------------------------------+---------------------------+---------------------------------------+--------------------------------+


Summarizing data
----------------

.. container:: multilang-table

    +--------------------------------------------------+---------------------------------+-------------------------------------+-----------------------------------+
    |                   Description                    |              STATA              |                Pandas               |               Base R              |
    +==================================================+=================================+=====================================+===================================+
    |                                                  | .. code-block:: none            | .. code-block:: python              | .. code-block:: none              |
    |                                                  |                                 |                                     |                                   |
    | Print summary statistics                         |     summarize                   |     df.describe()                   |     summary(df)                   |
    |                                                  |                                 |                                     |                                   |
    |                                                  |                                 |                                     |                                   |
    |                                                  |                                 |                                     |                                   |
    |                                                  |                                 |                                     |                                   |
    +--------------------------------------------------+---------------------------------+-------------------------------------+-----------------------------------+
    |                                                  | .. code-block:: none            | .. code-block:: python              | .. code-block:: none              |
    |                                                  |                                 |                                     |                                   |
    | Print information about variables and data types |     describe                    |     df.info()                       |    str(df)                        |
    +--------------------------------------------------+---------------------------------+-------------------------------------+-----------------------------------+
    |                                                  | .. code-block:: none            | .. code-block:: python              | .. code-block:: none              |
    |                                                  |                                 |                                     |                                   |
    | Print aggregation of variable                    |     mean x                      |     df['x'].mean()                  |     mean(df$x)                    |
    +--------------------------------------------------+---------------------------------+-------------------------------------+-----------------------------------+
    |                                                  | .. code-block:: none            | .. code-block:: python              | .. code-block:: none              |
    |                                                  |                                 |                                     |                                   |
    | Group data by variable and summarize             |     bysort x: summarize         |     df.groupby('x').describe()      |     aggregate(. ~ x, df, summary) |
    +--------------------------------------------------+---------------------------------+-------------------------------------+-----------------------------------+
    |                                                  | .. code-block:: none            | .. code-block:: python              | .. code-block:: none              |
    |                                                  |                                 |                                     |                                   |
    | Print frequency table                            |     tab x                       |     df['x'].value_counts()          |    table(df$x)                    |
    +--------------------------------------------------+---------------------------------+-------------------------------------+-----------------------------------+
    |                                                  | .. code-block:: none            | .. code-block:: python              | .. code-block:: none              |
    |                                                  |                                 |                                     |                                   |
    | Print cross-tabulation                           |     tab x y                     |     pd.crosstab(df['x'], df['y'])   |    table(df$x, df$y)              |
    +--------------------------------------------------+---------------------------------+-------------------------------------+-----------------------------------+
    |                                                  | .. code-block:: none            | .. code-block:: python              | .. code-block:: none              |
    |                                                  |                                 |                                     |                                   |
    | Create bins based                                |     egen bins = cut x, group(3) |     df['bins'] = pd.cut(df['x'], 3) |    df$bins <- cut(df$x, 3)        |
    | on values in x in new column 'bins'              |                                 |                                     |                                   |
    +--------------------------------------------------+---------------------------------+-------------------------------------+-----------------------------------+

Reshaping data
--------------

.. container:: multilang-table

    +--------------------------------------+-----------------------------+--------------------------------------------+------------------------------------------------------------------------------------+
    |              Operation               |            STATA            |                   Pandas                   |                                       Base R                                       |
    +======================================+=============================+============================================+====================================================================================+
    |                                      | .. code-block:: none        | .. code-block:: python                     | .. code-block:: none                                                               |
    |                                      |                             |                                            |                                                                                    |
    | Reshape data from wide to long panel |   reshape long x, i(i) j(j) |   pd.wide_to_long(df, ['x'], i='i', j='j') |    reshape(df, direction=’long’, varying=grep(‘x’, names(df), value=TRUE), sep='') |
    +--------------------------------------+-----------------------------+--------------------------------------------+------------------------------------------------------------------------------------+
    |                                      | .. code-block:: none        | .. code-block:: python                     | .. code-block:: none                                                               |
    |                                      |                             |                                            |                                                                                    |
    | Reshape data from long to wide panel |     reshape wide            |     df.unstack()                           |     reshape(df, direction='wide', varying=x, value=TRUE), sep='')                  |
    |                                      |                             |                                            |                                                                                    |
    |                                      |                             |     # returns hierarchical columns         |                                                                                    |
    +--------------------------------------+-----------------------------+--------------------------------------------+------------------------------------------------------------------------------------+


Merging data
------------

.. container:: multilang-table

    +---------------------------------+--------------------------+------------------------------------------+----------------------------------------------------------+
    |            Operation            |          STATA           |                  Pandas                  |                          Base R                          |
    +=================================+==========================+==========================================+==========================================================+
    |                                 | .. code-block:: none     | .. code-block:: python                   | .. code-block:: none                                     |
    |                                 |                          |                                          |                                                          |
    | Vertically concatenate datasets |    append using y        |    pd.concat([x, y])                     |    rbind(x, y)                                           |
    |                                 |                          |                                          |                                                          |
    |                                 |                          |                                          |    # note that columns must be the same for each dataset |
    |                                 |                          |                                          |                                                          |
    |                                 |                          |                                          |                                                          |
    +---------------------------------+--------------------------+------------------------------------------+----------------------------------------------------------+
    |                                 | .. code-block:: none     | .. code-block:: python                   | .. code-block:: none                                     |
    |                                 |                          |                                          |                                                          |
    | Merge datasets on key           |    merge 1:1 key using y |    pd.merge(x, y, on='key', how='inner') |    merge(x, y, by='key')                                 |
    +---------------------------------+--------------------------+------------------------------------------+----------------------------------------------------------+


Plotting
--------

.. container:: multilang-table

    +--------------+----------------------+-------------------------------+----------------------+
    |  Operation   |        STATA         |             Pandas            |        Base R        |
    +==============+======================+===============================+======================+
    |              | .. code-block:: none | .. code-block:: python        | .. code-block:: none |
    | Scatter plot |                      |                               |                      |
    |              |     plot x y         |     df.plot.scatter('x', 'y') |   plot(df$x, df$y)   |
    |              |                      |                               |                      |
    |              |                      |                               |                      |
    |              |                      |                               |                      |
    |              |                      |                               |                      |
    +--------------+----------------------+-------------------------------+----------------------+
    |              | .. code-block:: none | .. code-block:: python        | .. code-block:: none |
    | Line plot    |                      |                               |                      |
    |              |     line x y         |     df.plot('x', 'y')         |   lines(df$x, df$y)  |
    |              |                      |                               |                      |
    |              |                      |                               |                      |
    |              |                      |                               |                      |
    |              |                      |                               |                      |
    +--------------+----------------------+-------------------------------+----------------------+
    |              | .. code-block:: none | .. code-block:: python        | .. code-block:: none |
    |              |                      |                               |                      |
    | Histogram    |     hist x           |     df.hist('x')              |    hist(df$x)        |
    +--------------+----------------------+-------------------------------+----------------------+
    |              | .. code-block:: none | .. code-block:: python        | .. code-block:: none |
    |              |                      |                               |                      |
    | Boxplot      |     graph box x      |     df.boxplot('x')           |    boxplot(df$x)     |
    +--------------+----------------------+-------------------------------+----------------------+



